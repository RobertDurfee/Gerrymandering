const express = require('express')
const http = require('http')

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// App Configuration
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

const app = express()

app.set('view engine', 'pug')

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// REST Methods
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

app.get('/states/:state/races/:race/years/:year/votes', (req, res) => {
  const state = req.params['state']
  const race = req.params['race']
  const year = req.params['year']
  const base = req.query['base']
  const overlay = req.query['overlay']

  res.render('votes', {
    title: `${state} ${race} ${year} ${base} ${overlay}`,
    baseURI: `/states/${state}/races/${race}/years/${year}/votes?group=${base}`,
    overlayURI: `/states/${state}/races/${race}/years/${year}/votes?group=${overlay}`,
  })
})

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Connect
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

http.createServer(app).listen(8007)
